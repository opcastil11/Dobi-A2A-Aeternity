{"version":3,"file":"schema.js","names":["BaseError","InternalError","MESSAGE_DIRECTION","WALLET_TYPE","SUBSCRIPTION_TYPES","METHODS","RPC_STATUS","rpcErrors","RpcError","toJSON","code","message","data","deserialize","json","RpcErr","find","cl","RpcInvalidTransactionError","constructor","_defineProperty","name","push","RpcRejectedByUserError","RpcUnsupportedProtocolError","RpcConnectionDenyError","RpcNotAuthorizeError","RpcPermissionDenyError","address","RpcInternalError","RpcNoNetworkById","networkId","RpcMethodNotFoundError"],"sources":["../../src/aepp-wallet-communication/schema.ts"],"sourcesContent":["// eslint-disable-next-line max-classes-per-file\nimport { Encoded } from '../utils/encoder.js';\nimport { BaseError, InternalError } from '../utils/errors.js';\n\n/**\n * @category aepp wallet communication\n */\nexport const enum MESSAGE_DIRECTION {\n  to_waellet = 'to_waellet',\n  to_aepp = 'to_aepp',\n}\n\n/**\n * @category aepp wallet communication\n */\nexport const enum WALLET_TYPE {\n  window = 'window',\n  extension = 'extension',\n}\n\n/**\n * @category aepp wallet communication\n */\nexport const enum SUBSCRIPTION_TYPES {\n  subscribe = 'subscribe',\n  unsubscribe = 'unsubscribe',\n}\n\n/**\n * @category aepp wallet communication\n */\nexport const enum METHODS {\n  readyToConnect = 'connection.announcePresence',\n  updateAddress = 'address.update',\n  address = 'address.get',\n  connect = 'connection.open',\n  unsafeSign = 'data.unsafeSign',\n  sign = 'transaction.sign',\n  signMessage = 'message.sign',\n  signTypedData = 'typedData.sign',\n  signDelegation = 'delegation.sign',\n  subscribeAddress = 'address.subscribe',\n  updateNetwork = 'networkId.update',\n  closeConnection = 'connection.close',\n}\n\n/**\n * @category aepp wallet communication\n */\nexport const enum RPC_STATUS {\n  CONNECTED = 'CONNECTED',\n  DISCONNECTED = 'DISCONNECTED',\n  WAITING_FOR_CONNECTION_REQUEST = 'WAITING_FOR_CONNECTION_REQUEST',\n}\n\ninterface RpcErrorAsJson {\n  code: number;\n  message: string;\n  data?: any;\n}\n\nconst rpcErrors: Array<(new (data?: any) => RpcError) & { code: number }> = [];\n\n/**\n * @category exception\n */\nexport abstract class RpcError extends BaseError {\n  static code: number;\n\n  code!: number;\n\n  data?: any;\n\n  toJSON(): RpcErrorAsJson {\n    return {\n      code: this.code,\n      message: this.message,\n      data: this.data,\n    };\n  }\n\n  static deserialize(json: RpcErrorAsJson): RpcError {\n    const RpcErr = rpcErrors.find((cl) => cl.code === json.code);\n    if (RpcErr == null) throw new InternalError(`Can't find RpcError with code: ${json.code}`);\n    return new RpcErr(json.data);\n  }\n}\n\n/**\n * @category exception\n */\nexport class RpcInvalidTransactionError extends RpcError {\n  static override code = 2;\n\n  override code = 2;\n\n  constructor(data?: any) {\n    super('Invalid transaction');\n    this.data = data;\n    this.name = 'RpcInvalidTransactionError';\n  }\n}\nrpcErrors.push(RpcInvalidTransactionError);\n\n/**\n * @category exception\n */\nexport class RpcRejectedByUserError extends RpcError {\n  static override code = 4;\n\n  override code = 4;\n\n  constructor(data?: any) {\n    super('Operation rejected by user');\n    this.data = data;\n    this.name = 'RpcRejectedByUserError';\n  }\n}\nrpcErrors.push(RpcRejectedByUserError);\n\n/**\n * @category exception\n */\nexport class RpcUnsupportedProtocolError extends RpcError {\n  static override code = 5;\n\n  override code = 5;\n\n  constructor() {\n    super('Unsupported Protocol Version');\n    this.name = 'RpcUnsupportedProtocolError';\n  }\n}\nrpcErrors.push(RpcUnsupportedProtocolError);\n\n/**\n * @category exception\n */\nexport class RpcConnectionDenyError extends RpcError {\n  static override code = 9;\n\n  override code = 9;\n\n  constructor(data?: any) {\n    super('Wallet deny your connection request');\n    this.data = data;\n    this.name = 'RpcConnectionDenyError';\n  }\n}\nrpcErrors.push(RpcConnectionDenyError);\n\n/**\n * @category exception\n */\nexport class RpcNotAuthorizeError extends RpcError {\n  static override code = 10;\n\n  override code = 10;\n\n  constructor() {\n    super('You are not connected to the wallet');\n    this.name = 'RpcNotAuthorizeError';\n  }\n}\nrpcErrors.push(RpcNotAuthorizeError);\n\n/**\n * @category exception\n */\nexport class RpcPermissionDenyError extends RpcError {\n  static override code = 11;\n\n  override code = 11;\n\n  constructor(address: Encoded.AccountAddress) {\n    super(`You are not subscribed for account ${address}`);\n    this.data = address;\n    this.name = 'RpcPermissionDenyError';\n  }\n}\nrpcErrors.push(RpcPermissionDenyError);\n\n/**\n * @category exception\n */\nexport class RpcInternalError extends RpcError {\n  static override code = 12;\n\n  override code = 12;\n\n  constructor() {\n    super('The peer failed to execute your request due to unknown error');\n    this.name = 'RpcInternalError';\n  }\n}\nrpcErrors.push(RpcInternalError);\n\n/**\n * @category exception\n */\nexport class RpcNoNetworkById extends RpcError {\n  static override code = 13;\n\n  override code = 13;\n\n  constructor(networkId: string) {\n    super(`Wallet can't find a network by id \"${networkId}\"`);\n    this.data = networkId;\n    this.name = 'RpcNoNetworkById';\n  }\n}\nrpcErrors.push(RpcNoNetworkById);\n\n/**\n * @category exception\n */\nexport class RpcMethodNotFoundError extends RpcError {\n  static override code = -32601;\n\n  override code = -32601;\n\n  constructor() {\n    super('Method not found');\n    this.name = 'RpcMethodNotFoundError';\n  }\n}\nrpcErrors.push(RpcMethodNotFoundError);\n"],"mappings":"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","ignoreList":[]}