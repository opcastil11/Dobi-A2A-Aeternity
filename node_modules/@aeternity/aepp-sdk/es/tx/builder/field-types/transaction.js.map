{"version":3,"file":"transaction.js","names":["decode","encode","Encoding","genTransactionField","tag","serialize","txParams","buildTx","ArrayBuffer","isView","_Buffer","from","startsWith","deserialize","buf","unpackTx","Transaction"],"sources":["../../../../src/tx/builder/field-types/transaction.ts"],"sourcesContent":["import { decode, encode, Encoded, Encoding } from '../../../utils/encoder.js';\nimport { Tag } from '../constants.js';\nimport type { unpackTx as unpackTxType, buildTx as buildTxType } from '../index.js';\n\nexport default function genTransactionField<T extends Tag = Tag>(\n  tag?: T,\n): {\n  serialize: (\n    // TODO: replace with `TxParams & { tag: T }`,\n    //  but fix TS2502 value is referenced directly or indirectly in its own type annotation\n    value: any,\n    options: { buildTx: typeof buildTxType },\n  ) => Buffer;\n  deserialize: (\n    value: Buffer,\n    options: { unpackTx: typeof unpackTxType },\n    // TODO: replace with `TxUnpacked & { tag: T }`,\n    //  TS2577 Return type annotation circularly references itself\n  ) => any;\n} {\n  return {\n    serialize(txParams, { buildTx }) {\n      if (ArrayBuffer.isView(txParams)) return Buffer.from(txParams as any);\n      if (typeof txParams === 'string' && txParams.startsWith('tx_')) {\n        return decode(txParams as Encoded.Transaction);\n      }\n      return decode(buildTx({ ...txParams, ...(tag != null && { tag }) }));\n    },\n\n    deserialize(buf, { unpackTx }) {\n      return unpackTx(encode(buf, Encoding.Transaction), tag);\n    },\n  };\n}\n"],"mappings":";AAAA,SAASA,MAAM,EAAEC,MAAM,EAAWC,QAAQ,QAAQ,2BAA2B;AAI7E,eAAe,SAASC,mBAAmBA,CACzCC,GAAO,EAcP;EACA,OAAO;IACLC,SAASA,CAACC,QAAQ,EAAE;MAAEC;IAAQ,CAAC,EAAE;MAC/B,IAAIC,WAAW,CAACC,MAAM,CAACH,QAAQ,CAAC,EAAE,OAAOI,OAAA,CAAOC,IAAI,CAACL,QAAe,CAAC;MACrE,IAAI,OAAOA,QAAQ,KAAK,QAAQ,IAAIA,QAAQ,CAACM,UAAU,CAAC,KAAK,CAAC,EAAE;QAC9D,OAAOZ,MAAM,CAACM,QAA+B,CAAC;MAChD;MACA,OAAON,MAAM,CAACO,OAAO,CAAC;QAAE,GAAGD,QAAQ;QAAE,IAAIF,GAAG,IAAI,IAAI,IAAI;UAAEA;QAAI,CAAC;MAAE,CAAC,CAAC,CAAC;IACtE,CAAC;IAEDS,WAAWA,CAACC,GAAG,EAAE;MAAEC;IAAS,CAAC,EAAE;MAC7B,OAAOA,QAAQ,CAACd,MAAM,CAACa,GAAG,EAAEZ,QAAQ,CAACc,WAAW,CAAC,EAAEZ,GAAG,CAAC;IACzD;EACF,CAAC;AACH","ignoreList":[]}