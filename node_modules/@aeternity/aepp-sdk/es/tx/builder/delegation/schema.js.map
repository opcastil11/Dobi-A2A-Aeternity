{"version":3,"file":"schema.js","names":["address","nameId","shortUIntConst","Encoding","decode","encode","DelegationTag","oracleAddressField","OracleAddress","queryIdField","serialize","value","deserialize","OracleQueryId","contractAddress","ContractAddress","schemas","tag","AensWildcard","version","accountAddress","AccountAddress","AensName","AensPreclaim","Oracle","OracleResponse","queryId"],"sources":["../../../../src/tx/builder/delegation/schema.ts"],"sourcesContent":["import SchemaTypes from '../SchemaTypes.js';\nimport address from '../field-types/address.js';\nimport nameId from '../field-types/name-id.js';\nimport shortUIntConst from '../field-types/short-u-int-const.js';\nimport { Encoded, Encoding, decode, encode } from '../../../utils/encoder.js';\n\n/**\n * @category delegation signature\n */\nexport enum DelegationTag {\n  /**\n   * Delegation of all AENS names to a contract\n   */\n  AensWildcard = 1,\n  /**\n   * Delegation of an AENS name to a contract\n   */\n  AensName = 2,\n  /**\n   * Delegation of AENS preclaim to a contract\n   */\n  AensPreclaim = 3,\n  /**\n   * Delegation of oracle operations to a contract\n   */\n  Oracle = 4,\n  /**\n   * Delegation of oracle query to a contract\n   */\n  OracleResponse = 5,\n}\n\nconst oracleAddressField = address(Encoding.OracleAddress);\n/**\n * Oracle query ID to reply by a contract\n */\nconst queryIdField = {\n  serialize(value: Encoded.OracleQueryId): Buffer {\n    return oracleAddressField.serialize(encode(decode(value), Encoding.OracleAddress));\n  },\n  deserialize(value: Buffer): Encoded.OracleQueryId {\n    return encode(decode(oracleAddressField.deserialize(value)), Encoding.OracleQueryId);\n  },\n} as const;\n\n/**\n * Address of a contract to delegate permissions to\n */\nconst contractAddress = address(Encoding.ContractAddress);\n\n/**\n * @see {@link https://github.com/aeternity/protocol/blob/8a9d1d1206174627f6aaef86159dc9c643080653/contracts/fate.md#from-ceres-serialized-signature-data}\n */\nexport const schemas = [\n  {\n    tag: shortUIntConst(DelegationTag.AensWildcard),\n    version: shortUIntConst(1, true),\n    accountAddress: address(Encoding.AccountAddress),\n    contractAddress,\n  },\n  {\n    tag: shortUIntConst(DelegationTag.AensName),\n    version: shortUIntConst(1, true),\n    accountAddress: address(Encoding.AccountAddress),\n    /**\n     * AENS name to manage by a contract\n     */\n    nameId,\n    contractAddress,\n  },\n  {\n    tag: shortUIntConst(DelegationTag.AensPreclaim),\n    version: shortUIntConst(1, true),\n    accountAddress: address(Encoding.AccountAddress),\n    contractAddress,\n  },\n  {\n    tag: shortUIntConst(DelegationTag.Oracle),\n    version: shortUIntConst(1, true),\n    accountAddress: address(Encoding.AccountAddress),\n    contractAddress,\n  },\n  {\n    tag: shortUIntConst(DelegationTag.OracleResponse),\n    version: shortUIntConst(1, true),\n    queryId: queryIdField,\n    contractAddress,\n  },\n] as const;\n\ntype Schemas = SchemaTypes<typeof schemas>;\nexport type DlgParams = Schemas['TxParams'];\nexport type DlgUnpacked = Schemas['TxUnpacked'];\n"],"mappings":"AACA,OAAOA,OAAO,MAAM,2BAA2B;AAC/C,OAAOC,MAAM,MAAM,2BAA2B;AAC9C,OAAOC,cAAc,MAAM,qCAAqC;AAChE,SAAkBC,QAAQ,EAAEC,MAAM,EAAEC,MAAM,QAAQ,2BAA2B;;AAE7E;AACA;AACA;AACA,WAAYC,aAAa,0BAAbA,aAAa;EACvB;AACF;AACA;EAHYA,aAAa,CAAbA,aAAa;EAKvB;AACF;AACA;EAPYA,aAAa,CAAbA,aAAa;EASvB;AACF;AACA;EAXYA,aAAa,CAAbA,aAAa;EAavB;AACF;AACA;EAfYA,aAAa,CAAbA,aAAa;EAiBvB;AACF;AACA;EAnBYA,aAAa,CAAbA,aAAa;EAAA,OAAbA,aAAa;AAAA;AAuBzB,MAAMC,kBAAkB,GAAGP,OAAO,CAACG,QAAQ,CAACK,aAAa,CAAC;AAC1D;AACA;AACA;AACA,MAAMC,YAAY,GAAG;EACnBC,SAASA,CAACC,KAA4B,EAAU;IAC9C,OAAOJ,kBAAkB,CAACG,SAAS,CAACL,MAAM,CAACD,MAAM,CAACO,KAAK,CAAC,EAAER,QAAQ,CAACK,aAAa,CAAC,CAAC;EACpF,CAAC;EACDI,WAAWA,CAACD,KAAa,EAAyB;IAChD,OAAON,MAAM,CAACD,MAAM,CAACG,kBAAkB,CAACK,WAAW,CAACD,KAAK,CAAC,CAAC,EAAER,QAAQ,CAACU,aAAa,CAAC;EACtF;AACF,CAAU;;AAEV;AACA;AACA;AACA,MAAMC,eAAe,GAAGd,OAAO,CAACG,QAAQ,CAACY,eAAe,CAAC;;AAEzD;AACA;AACA;AACA,OAAO,MAAMC,OAAO,GAAG,CACrB;EACEC,GAAG,EAAEf,cAAc,CAACI,aAAa,CAACY,YAAY,CAAC;EAC/CC,OAAO,EAAEjB,cAAc,CAAC,CAAC,EAAE,IAAI,CAAC;EAChCkB,cAAc,EAAEpB,OAAO,CAACG,QAAQ,CAACkB,cAAc,CAAC;EAChDP;AACF,CAAC,EACD;EACEG,GAAG,EAAEf,cAAc,CAACI,aAAa,CAACgB,QAAQ,CAAC;EAC3CH,OAAO,EAAEjB,cAAc,CAAC,CAAC,EAAE,IAAI,CAAC;EAChCkB,cAAc,EAAEpB,OAAO,CAACG,QAAQ,CAACkB,cAAc,CAAC;EAChD;AACJ;AACA;EACIpB,MAAM;EACNa;AACF,CAAC,EACD;EACEG,GAAG,EAAEf,cAAc,CAACI,aAAa,CAACiB,YAAY,CAAC;EAC/CJ,OAAO,EAAEjB,cAAc,CAAC,CAAC,EAAE,IAAI,CAAC;EAChCkB,cAAc,EAAEpB,OAAO,CAACG,QAAQ,CAACkB,cAAc,CAAC;EAChDP;AACF,CAAC,EACD;EACEG,GAAG,EAAEf,cAAc,CAACI,aAAa,CAACkB,MAAM,CAAC;EACzCL,OAAO,EAAEjB,cAAc,CAAC,CAAC,EAAE,IAAI,CAAC;EAChCkB,cAAc,EAAEpB,OAAO,CAACG,QAAQ,CAACkB,cAAc,CAAC;EAChDP;AACF,CAAC,EACD;EACEG,GAAG,EAAEf,cAAc,CAACI,aAAa,CAACmB,cAAc,CAAC;EACjDN,OAAO,EAAEjB,cAAc,CAAC,CAAC,EAAE,IAAI,CAAC;EAChCwB,OAAO,EAAEjB,YAAY;EACrBK;AACF,CAAC,CACO","ignoreList":[]}